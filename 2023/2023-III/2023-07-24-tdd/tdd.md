# Как правильно относиться к TDD

## Плюсы моего стиля применения TDD

### 1. Тестирование всех публичных методов и функций
Покрытие кода тестами действительно хорошее.
На порядок лучше, чем до знакомства с TDD.

Это очень сильно помогает при рефакторинге - ошибки быстро обнаруживаются.


### 2. Слабая связность
Стремление тестировать разные компоненты независимо друг от друга
уменьшает их связность.

При использовании TDD автоматически получаются более компактные
и самодостаточные модули.


### 3. Удобный интерфейс
Часто решение об изменении набора методов и входных параметров принимается
после написания тестов.
Когда пишешь много тестов повторяющиеся громоздкие и неудобные конструкции
сразу бросаются в глаза.


## Минусы моего стиля применения TDD

### 1. Проверяется очень небольшое количество сценариев использования
Проверяется вызов метода на небольшом множестве наборов корректных параметров.
Часто используется всего один набор параметров.

Проверка работы методов и функций с некорректными параметрами распространена
ещё меньше (хотя присутствует, особенно для ключевых АТД).


### 2. Нет проверки взаимодействия между компонентами
Каждый класс или функция тестируются максимально независимо от других
частей программы.
В то же время реальные расчёты часто предполагают очень длинные цепочки
преобразования данных.
Для обнаружения ошибки может потребоваться её распространение по этой цепочке
на несколько шагов.


### 3. Нет уверенности в корректности тестов
Некоторые функции выдают большой объём данных в качестве результата.
В этом случае высока вероятность ошибки при написании теста из-за
высокой сложности математической модели и недостатка внимания.

Особенно трудно найти ошибки, которые меняют результат незначительно,
так что физический его смысл сохраняется, и кажется, что всё работает корректно.


## Резюме
Мой стиль TDD - это скорее техника тестирования.
Она оказывает влияние на дизайн на низком уровне, но не глобально на программу.
Эта техника тестирования, однако, в своё время стала для меня революционной.

Революции было две.
Первая - внедрение автоматического тестирования.
Тогда я ещё писал на языке D и стал активно использовать
встроенную поддержку юниттестов.
До этого я, как и многие коллеги, тестировал каждую новую функцию вручную,
а потом её было лучше не трогать, иначе придётся тестировать снова.
Автоматическое тестирование решило эту проблему,
сделав разработку быстрее, а код - надёжнее и гибче.
Можно было уже не бояться сломать что-то незаметно для себя.

Вторая революция - применение TDD.
Не помню точно где я прочитал про этот подход.
Скорее всего, в одной из книг Роберта Мартина.

Главный плюс - на порядок лучшее покрытие кода тестами.
Новый код вообще не пишется без тестов.
По началу это было очень сложно.
До сих пор бывает, что я добавляю какие-то классы или функции до или без тестов.
Тогда сразу чувствуется польза TDD.
Да, вначале кажется, что начинать с кода проще, но когда он, вроде бы, работает,
тесты уже как бы и не нужны.
А потом оказывается, что их нет, а они нужны.

Уменьшение связности и улучшение интерфейса - это тоже очень приятно,
но этого можно достичь другими путями.
Даже не просто можно, а нужно,
ведь TDD не избавляет от необходимости думать о коде на уровне логики.
Тут не должно быть иллюзий и тем более фанатичной веры в какой-либо метод.

Что касается покрытия кода юниттестами - тут я не знаю ничего лучше TDD.
Для меня это наиболее комфортный и эффективный способ самодисциплины в этом
вопросе.

Таким образом, я воспринимаю TDD как технику тестирования,
которая имеет огромный дисциплинирующий эффект
и значительно улучшает качество моего кода.

Теперь, когда мои проекты становятся всё сложнее, пора бы и другие техники
тестирования осваивать.

Парадигмы разработки и дизайн для меня - область ортогональная тестированию.
Это, конечно, не означает, что в условном пространстве дизайн-тестирование
все точки равноправны.
Код, который легче тестируется, скорее всего и по дизайну хорош, например,
чистые функции и иммутабельные данные.
